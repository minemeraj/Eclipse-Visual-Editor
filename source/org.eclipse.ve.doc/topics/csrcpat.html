<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html
  PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="copyright" content="(C) Copyright IBM Corporation 2004" />
<meta name="DC.rights.owner" content="(C) Copyright IBM Corporation 2004" />
<meta name="security" content="public" />
<meta name="Robots" content="index,follow" />
<meta http-equiv="PICS-Label" content='(PICS-1.1 "http://www.icra.org/ratingsv02.html" l gen true r (cz 1 lz 1 nz 1 oz 1 vz 1) "http://www.rsac.org/ratingsv01.html" l gen true r (n 0 s 0 v 0 l 0) "http://www.classify.org/safesurf/" l gen true r (SS~~000 1))' />
<meta name="DC.Type" content="concept" />
<meta name="DC.Title" content="Source code patterns" />
<meta name="abstract" content="The Visual Editor uses code rules for parsing Java code for display on the canvas and for generating Java code." />
<meta name="description" content="The Visual Editor uses code rules for parsing Java code for display on the canvas and for generating Java code." />
<meta name="DC.Relation" scheme="URI" content="ccodesync.dita" />
<meta name="DC.Relation" scheme="URI" content="ccodegen.dita" />
<meta name="DC.Relation" scheme="URI" content="cextstring.dita" />
<meta name="DC.Relation" scheme="URI" content="cstylegendsrc.dita" />
<meta name="DC.Relation" scheme="URI" content="cmetamig.dita" />
<meta name="DC.Relation" scheme="URI" content="csrcevent.dita" />
<meta name="DC.Format" content="XHTML" />
<meta name="DC.Identifier" content="csrcpat" />
<meta name="DC.Language" content="en-us" />
<!-- All rights reserved. Licensed Materials Property of IBM -->
<!-- US Government Users Restricted Rights -->
<!-- Use, duplication or disclosure restricted by -->
<!-- GSA ADP Schedule Contract with IBM Corp. -->
<link rel="stylesheet" type="text/css" href="../ibmdita.css" />
<link rel="stylesheet" type="text/css" href="../swg_info_common.css" />
<title>Source code patterns</title>
</head>
<body id="csrcpat"><a name="csrcpat"><!-- --></a>

<h1 class="topictitle1">Source code patterns</h1>
<div><p>The Visual Editor uses code rules for parsing Java code for display
on the canvas and for generating Java code.</p>
<p>The source code style currently used by the Visual Editor for Java is based
upon the style generated by VisualAge for Java. When the .java file is opened,
a model of the Java beans, their initial property values, and any relationships
between them are created.</p>
<p>To determine the Java beans that appear on the canvas and Java Beans viewer,
the Visual Editor analyzes each field to determine whether or not it should
be included. To be recognized as a Java bean, the following rules must
be satisfied:</p>
<ul><li>The field name must either start with the letters <samp class="codeph">ivj</samp> or
be a visual Java bean whose type is a subclass of  <samp class="codeph">java.awt.Component</samp>.<div class="note"><span class="notetitle">Note: </span>Fields
that start with <samp class="codeph">ivjConn</samp> are not treated as Java beans.</div>
</li>
<li>The field must be instantiated within a <samp class="codeph">get</samp> method, or
the bean must be initialized in a method that is specified on the Pattern
Styles tab of the in the Visual Editor Preferences page. Notice in the following
image that the <samp class="codeph">jbInit</samp>, <samp class="codeph">initComponents</samp>, and <samp class="codeph">initialize</samp> methods
are specified as initialization methods:   <br /><img src="../images/CodePattern1.gif" alt="Code pattern 1" /><br /></li>
</ul>
<p>For example, the following fields are recognized as candidate
Java beans:</p>
<div class="p"><pre><samp class="codeph">private javax.swing.JPanel ivjJPanel;</samp>
<samp class="codeph">private javax.swing.JButton anOKButton;</samp>
<samp class="codeph">private javax.swing.table.TableModel ivjTableModel;</samp></pre>
</div>
<p>If <samp class="codeph">ivjTableModel</samp> were simply named <samp class="codeph">TableModel</samp>,
it would not be included in the list of Visual Editor Java beans. However, <samp class="codeph">anOKButton</samp> is
included because the class <samp class="codeph">javax.swing.JButton</samp> is a descendent
of <samp class="codeph">java.awt.Component</samp>, making it a visual Java bean.</p>
<p>In addition to having the correct field name, each field must be instantiated
within a <samp class="codeph">get</samp> method. The  <samp class="codeph">getPanel()</samp> method
sets the field <samp class="codeph">ivjJPanel</samp> to be an instance of <samp class="codeph">javax.swing.JPanel</samp>,
so <samp class="codeph">ivjJPanel</samp> satisfies the rules to be recognized as Java
bean by the Visual Editor.</p>
<div class="p"><pre>private javax.swing.JPanel getJPanel() {
    if ( ivjJPanel == null ) {
        ivjJPanel = new javax.swing.JPanel();
        ivjJPanel.setBackground(java.awt.Color.cyan); 
   }
} </pre>
 </div>
<p>Although the Visual Editor generates methods such as <samp class="codeph">getPanel()</samp> that
instantiate and return a single Java bean, this is not a requirement. A
method can instantiate more than one Java bean, and the return value of the
method is not important for recognizing whether the field is a Java bean. For
the fields <samp class="codeph">anOKButton</samp> and <samp class="codeph">ivjTableModel</samp> to
be included as Java beans, they will need to be instantiated within a <samp class="codeph">get</samp> method
in the class.</p>
<p>After a method is found for the Java bean that instantiates it, it is further
analyzed for design time property settings. In  <samp class="codeph">getJPanel()</samp>,
the method  <samp class="codeph">ivjJPanel.setBackground(java.awt.Color.cyan)</samp> is
used to determine the initial value of the <samp class="codeph">background</samp> property
for the Java bean shown in the canvas and the Properties view.</p>
<p>If the edited class extends a Java bean, the instance being edited is represented
with a special Java bean called a 'this' part. The 'this' part cannot be deleted
from the Design view or Java Beans view, and the initialization method for
its properties are done in the <samp class="codeph">initialize()</samp> method. A 'this'
part is only shown in the Design view and Java Beans view if there are any
properties that would be available to set on the Properties view. The set
methods for the properties are generated in the  <samp class="codeph">initialize()</samp> method,
or if the class extends <samp class="codeph">java.awt.Applet</samp> the <samp class="codeph">init()</samp> method
is used.</p>
<p>When the arguments to a property's set method are parsed, such as the "Hello_World_1"
String argument to the setTitle method, the Visual Editor attempts to construct
a Java bean for the property value. Most expressions are successfully parsed,
but not all expressions can be correctly evaluated. In this case a warning
sign will be shown against the Java bean in the views, and the reason for
the failure will be shown in the status line Notice the orientation warning
in the status line in the following screen image:<br /><img src="../images/ScrollBarParsingError.gif" alt="Java perspective with Visual Editor" /><br /></p>
<p>The following set of rules must be met for an expression to be successfully
parsed by the Visual Editor:</p>
<ul><li>There must not be a compilation error on the line</li>
<li>A class must be valid to load and instantiate</li>
<li>Most array initialization expressions cannot be evaluated</li>
<li>Expressions that involve arithmetic or string concatenation using the
+ operand will be not be evaluated</li>
</ul>
<p>When a set method is parsed, it is only applied to the Java bean if it
is a set method that is associated with a <samp class="codeph">java.beans.PropertyDescriptor</samp>.</p>
</div>
<div><p><b class="relconceptshd">Related concepts</b><br />
<a href="ccodesync.html" title="">Code synchronization</a><br />
<a href="ccodegen.html" title="">Code generation</a><br />
<a href="cextstring.html" title="">Externalized strings</a><br />
<a href="cstylegendsrc.html" title="">Style of generated source</a><br />
<a href="cmetamig.html" title="">Metadata and migrating from VisualAge for Java</a><br />
<a href="csrcevent.html" title="">Event handling</a><br />
</p>
</div><div class="runningfooter"><p></p>(C) Copyright IBM Corporation 1999, 2004. All Rights Reserved.
<br />
</div>
</body>
</html>